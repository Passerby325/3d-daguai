# 3D RPG 游戏 - AI智能敌人

## 项目简介

这是一个基于 Three.js 的 3D RPG 游戏（名为"打怪物"），具有 AI 智能敌人系统和 Boss 战斗机制。玩家可以在 3D 开放世界中探索、战斗，体验逐渐提升的难度挑战。

## 技术栈

- **Three.js 0.160.0** - 3D 渲染引擎
- **JavaScript (ES6+)** - 编程语言，采用模块化设计
- **HTML5/CSS3** - 前端界面

## 项目结构

```
version/
├── index.html              # 游戏入口页面
├── 说明书.txt              # 游戏说明书
├── src/
│   ├── main.js            # 游戏主入口
│   ├── core/
│   │   └── Game.js        # 游戏核心类（场景、渲染、更新循环）
│   ├── player/
│   │   └── Player.js      # 玩家类（移动、攻击、武器系统）
│   ├── enemies/
│   │   ├── Enemy.js       # 敌人基类（状态机 AI）
│   │   ├── EnemyManager.js # 敌人管理器（生成、AI 更新）
│   │   └── Boss.js        # Boss 类（特殊技能、狂暴模式）
│   ├── combat/
│   │   ├── CombatSystem.js # 战斗系统（伤害计算、击退）
│   │   └── BulletSystem.js # 子弹系统（射击、掉落）
│   ├── ui/
│   │   └── MiniMap.js     # 小地图（玩家和敌人位置追踪）
│   └── ai/
│       └── LLMService.js  # AI 服务（集成大语言模型）
└── assets/                 # 资源文件夹
```

## 核心功能

### 玩家系统

- 第一人称视角控制
- **WASD** 移动 + 鼠标视角
- **空格** 跳跃
- **Shift** 加速奔跑（消耗体力）
- **左键** 攻击/射击
- **右键** 切换武器（剑/手枪）
- 100 生命值，受伤后屏幕红色闪烁
- 体力系统：加速消耗体力，站立/行走恢复
- 击杀敌人回复体力和补充弹药
- 武器系统：剑（近战）+ 手枪（远程射击）

### 敌人 AI 系统

- **状态机 AI**：空闲(IDLE)、巡逻(PATROL)、追击(CHASE)、攻击(ATTACK)、逃跑(FLEE)、死亡(DEAD)
- 难度系统：每 30 秒提升难度等级
- 难度提升时敌人属性增强（血量+20%、伤害+20%、速度+20%、体型变大）
- 敌人血条显示
- 受伤/攻击时 AI 对话气泡

### Boss 战斗

- 每 10 秒生成一个 Boss
- Boss 基础属性远超普通敌人（500血、30伤害）
- Boss 特有技能：
  - **冲锋(CHARGE)**：8秒冷却，快速冲向玩家
  - **砸地(SMASH)**：12秒冷却，范围伤害 + 屏幕震动
  - **召唤(SUMMON)**：15秒冷却，召唤小怪协助战斗
- 狂暴模式：30% 血量时进入，属性大幅提升
- Boss 血条 UI 显示

### 战斗系统

- 扇形攻击范围检测（剑：60°/7米）
- 子弹系统：手枪射击（25伤害/0.3s冷却）
- 伤害计算与击退效果
- 伤害数字浮动显示
- 弹药系统：击杀敌人掉落子弹

### 击败奖励

- 击杀普通敌人：回复15点体力，掉落1发子弹
- 击杀 Boss：
  - 玩家基础速度 +2
  - 玩家冲刺速度 +3
  - 子弹掉落数量 +1

### 小地图

- 实时显示玩家位置（绿色标记）
- 敌人位置标记（红色点）
- Boss 位置标记（紫色大点）
- 视野方向指示（绿色视野锥）
- **M 键** 切换镜像模式
- 200x200 米地图范围

### 视觉效果

- 3D 场景渲染（天空、雾气）
- 动态光源与阴影
- 环境障碍物（树木、岩石）
- 敌人颜色随状态变化
- Boss 死亡特效、胜利提示

## 运行方式

1. 使用本地服务器运行（如 VS Code Live Server）
2. 在浏览器中打开 `index.html`
3. 点击"开始游戏"并锁定指针
4. 使用 WASD 移动，鼠标控制视角

## 操作说明

| 按键 | 功能 |
|------|------|
| W/A/S/D | 移动 |
| 鼠标 | 视角控制 |
| 左键 | 攻击/射击 |
| 右键 | 切换武器 |
| 空格 | 跳跃 |
| Shift | 加速奔跑 |
| M | 切换小地图镜像模式 |
| ESC | 暂停/解锁鼠标 |

## 秘密指令

- **输入 kkkk**：开启/关闭无限子弹

## 难度系统

- 初始难度 1 级，5 个敌人
- 每 30 秒难度提升 1 级
- 每级增加：
  - 最大敌人数 +3
  - 敌人属性 +20%（血量、伤害、速度）
  - 敌人体型变大
  - 生成间隔缩短

## AI 对话系统

游戏内置预设对话，也可配置大模型 API 实现智能对话：

- OpenAI
- Claude
- DeepSeek

配置方式：在 `src/ai/LLMService.js` 中填入 API Key

## 依赖

- Three.js (通过 CDN 引入，无需安装)
